# 📈 Kiwoom Auto Trading System

키움증권 OpenAPI+ 기반 자동매매 프로그램입니다.  
PyQt5와 ActiveX 통신을 활용해 실시간 시세 수신, 조건 검색, 자동 주문 등을 지원합니다.

---

## 🛠️ 프로젝트 개요

이 프로젝트는 Python 기반 PyQt5 GUI 환경에서 키움 OpenAPI+를 활용하여 주식 자동매매를 수행합니다.  
이벤트 루프 기반으로 로그인, 실시간 체결, 주문, 잔고, 조건식 기반 종목 분석 등의 기능을 갖추고 있으며,  
로깅 및 예외처리 기능도 포함됩니다.

---

## 📂 프로젝트 구조
📁 project-root/\n
├── init.py # 앱 초기화 및 실행
├── kiwoom/
│ └── kiwoom.py # 핵심 Kiwoom API 자동매매 로직 구현
├── config/
│ ├── log_class.py # 로깅 클래스
│ ├── errorCode.py # 키움 API 오류 코드 정의
│ └── kiwoomType.py # 실시간/체결/잔고 관련 FID 정보 정의
└── files/
└── condition_stock.txt # 조건검색에 통과한 종목 저장 파일

---

## 🚀 실행 방법

1. **필수 라이브러리 설치**

   ```bash
   pip install PyQt5
2. **키움 OpenAPI+ 설치**
3. **프로그램실행**
   python __init__.py

## 🔧 주요 기능
- 🔐 로그인 자동 처리
● PyQt 이벤트 루프를 통해 자동 로그인 처리

- 📊 예수금 / 잔고 조회
● opw00001, opw00018 API 요청을 통한 계좌 상태 확인

- ⚙️ 조건 검색 기반 종목 선정
● 120일 이동평균선 돌파 등 전략 기반 종목 필터링

- 🔄 실시간 시세 / 체결 감지
● 장시작/장마감, 현재가, 호가, 체결량 등 실시간 수신

- 🛒 자동 매수 / 매도 주문
● 수익률 5% 초과 시 자동 매도, 급등 종목 자동 매수

- 📜 로깅 & 예외 처리
● log_class.py 기반 에러 로그 출력 및 저장

## 💡 조건식 전략 예시
📌 120일 이동평균선 전략 기반 종목 선정 조건
● 최근 종가가 120일 이평선에 걸쳐 있을 것
● 과거 20일 동안 주가가 이평선보다 낮았을 것
● 최근 120일 이평선이 과거보다 상승했을 것

## 🧪 사용 기술
● Python 3.7
● PyQt5
● 키움 OpenAPI+ (ActiveX)
● 객체지향 프로그래밍 구조

## 📘 참조한 서적
손가락 하나 까딱하지 않는 주식 거래 시스템 구축
장용준 저 | 한빛미디어
